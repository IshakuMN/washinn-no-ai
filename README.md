# WashInn No-AI (Nuxt 4 + Firebase RTDB + Layers)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Nuxt 4 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Firebase Realtime Database (RTDB), Cloud Functions –∏ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ Nuxt Layers.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1.  **Nuxt Layers (–°–ª–æ–∏):** –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.
2.  **Firebase Emulators:** –ü–æ–ª–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (DB, Functions).
3.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è RTDB:** –û–±—Ä–∞—Ç–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (Reverse Indexes) –∏ Cloud Functions –¥–ª—è –∏—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
4.  **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤—Å–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏.

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js (v20+)
- Java (v21+) –¥–ª—è —ç–º—É–ª—è—Ç–æ—Ä–æ–≤ Firebase

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ (–¥–ª—è Firebase Functions)
cd functions
npm install

# Frontend (Nuxt)
cd ../frontend
npm install

# Base Module (Layer)
cd ../modules/base
npm install
```

### 2. –ó–∞–ø—É—Å–∫ –≠–º—É–ª—è—Ç–æ—Ä–æ–≤ Firebase

–û—Ç–∫—Ä–æ–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª:

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Java 21 –≤ PATH
export PATH="/opt/homebrew/opt/openjdk@21/bin:$PATH"

# –ó–∞–ø—É—Å–∫ —ç–º—É–ª—è—Ç–æ—Ä–æ–≤
npx firebase-tools emulators:start
```

–≠–º—É–ª—è—Ç–æ—Ä—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:4000`

### 3. –ó–∞–ø—É—Å–∫ Frontend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```bash
cd frontend
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞: `http://localhost:3000`

---

## üìö –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–æ—á–µ–º—É RTDB –Ω—É–∂–Ω—ã Reverse Indexes (–û–±—Ä–∞—Ç–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã)?

Firebase Realtime Database ‚Äî —ç—Ç–æ JSON-–¥–µ—Ä–µ–≤–æ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç SQL –∏–ª–∏ Firestore, –æ–Ω–∞ –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—è `tasks` —Å 10,000 –∑–∞–¥–∞—á, –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞–π—Ç–∏ –∑–∞–¥–∞—á–∏ –ü—Ä–æ–µ–∫—Ç–∞ –ê, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.orderByChild('projectId').equalTo('A')` —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è `assignee`, –∏ –ø—Ä–∏ —ç—Ç–æ–º –æ–Ω–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ ‚Äì —Å–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ RTDB –¥–µ–ª–∞—Ç—å —Ç—Ä—É–¥–Ω–æ –∏–ª–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –¢–∞–∫–∂–µ, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ (Reverse Index):**
–ú—ã —Å–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∏:

```json
"tasksByProject": {
  "project_A_id": {
    "task_1_id": true,
    "task_5_id": true
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- **–°–∫–æ—Ä–æ—Å—Ç—å:** –ß—Ç–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª—é—á–µ–π –ø–æ ID –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
- **–¢—Ä–∞—Ñ–∏–∫:** –ú—ã –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ–º –≤–µ—Å—å –º–∞—Å—Å–∏–≤ –∑–∞–¥–∞—á –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ù–µ –≤–∞–∂–Ω–æ, —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –∑–∞–¥–∞—á –≤ –±–∞–∑–µ (100 –∏–ª–∏ 1–º–ª–Ω), –≤—ã–±–æ—Ä–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤—Å–µ–≥–¥–∞ –±—ã—Å—Ç—Ä–∞—è.

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ Cloud Function (`onTaskWrite`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏, –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á.

### 2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è?

–í —Ñ–∞–π–ª–µ `modules/base/pages/indexed-tasks.vue` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–∞—Ç—Ç–µ—Ä–Ω:

1.  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç.
2.  –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–ù–ï** –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å `tasks.orderByChild('projectId')`.
3.  –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, –æ–Ω–æ —á–∏—Ç–∞–µ—Ç `tasksByProject/{projectId}`. –≠—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–ø–∏—Å–æ–∫ ID: `['id1', 'id2']`.
4.  –ó–∞—Ç–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–æ—á–µ—á–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö ID (–∏–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–∏—Ö).

–≠—Ç–æ —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É –∏ —Å–µ—Ç—å.

### 3. –ü–æ—á–µ–º—É Nuxt Layers –ø–æ–ª–µ–∑–Ω—ã?

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞:

- `/frontend` (–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- `/modules/base` (–°–ª–æ–π/–ú–æ–¥—É–ª—å)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ú–æ–¥—É–ª—å `base` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `indexed-tasks.vue`), –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ª–æ–≥–∏–∫—É (`useLayerMenu`).
- **–ò–∑–æ–ª—è—Ü–∏—è:** –õ–æ–≥–∏–∫–∞ –º–æ–¥—É–ª—è –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞. Frontend –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –Ω–µ–≥–æ (`extends: ['../modules/base']`).
- **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:** –ú–µ–Ω—é –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –ø—É–Ω–∫—Ç—ã –∏–∑ —Å–ª–æ—è —á–µ—Ä–µ–∑ `useLayerMenu`, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è, –∫–∞–∫ —Å–ª–æ–∏ –º–æ–≥—É—Ç "–≤–Ω–µ–¥—Ä—è—Ç—å—Å—è" –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **`frontend/`**: –û—Å–Ω–æ–≤–Ω–æ–µ Nuxt –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
  - `app/pages/management.vue`: CRUD –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
  - `app/pages/relations.vue`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑—è–º–∏ (M:N).
- **`modules/base/`**: –°–ª–æ–π —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º.
  - `pages/indexed-tasks.vue`: –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å Reverse Index.
- **`functions/`**: Backend –ª–æ–≥–∏–∫–∞ (Triggers).
  - `src/index.ts`: –§—É–Ω–∫—Ü–∏—è `onTaskWrite` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–Ω–¥–µ–∫—Å–æ–≤.
- **`firebase.json`**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–º—É–ª—è—Ç–æ—Ä–æ–≤.
- **`database.rules.json`**: –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω–¥–µ–∫—Å—ã –ë–î.
